<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="mail_act_meeting_rooms_approval" model="mail.activity.type">
        <field name="name">Meeting Rooms</field>
        <field name="icon">fa-sun-o</field>
        <field name="res_model_id" ref="meeting_rooms.model_meeting_rooms"/>
    </record>

    <record id="meeting_rooms_calendar_view" model="ir.ui.view">
        <field name="name">meeting_rooms_calendar_view</field>
        <field name="model">meeting.rooms</field>
        <field name="arch" type="xml">
            <calendar string="Meeting Date" date_start="start_date" date_stop="end_date" mode="day" quick_add="False" color="room_location">
                <field name="room_location"/>
                <field name="subject"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="attendee"/>
                <field name="state"/>
            </calendar>
        </field>
    </record>

    <record id="meeting_rooms_tree_view" model="ir.ui.view">
        <field name="name">meeting_rooms_tree_view</field>
        <field name="model">meeting.rooms</field>
        <field name="arch" type="xml">
            <tree string="Meeting Room Booking">
                <field name="subject"/>
                <field name="room_location"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="attendee" widget="many2many_tags"/>
                <field name="description"/>
                <field name="state"/>
                <button name="unlink" string="Delete" class="btn-danger fa-trash-o" type="object"/>
            </tree>
        </field>
    </record>

    <record id="meeting_rooms_from_view" model="ir.ui.view">
        <field name="name">meeting_rooms_from_view</field>
        <field name="model">meeting.rooms</field>
        <field name="arch" type="xml">
            <form string="Meeting Rooms Booking">
                <header>
                    <button name="action_confirm" type="object" states="draft" string="Confirm" class="oe_highlight"/>
                    <button name="action_cancel" type="object" states="confirm" string="Cancel"/>
                    <button name="action_draft" type="object" states="cancel" string="Set To Draft"/>
                    <button name="send_email_meeting" type="object" string="Send Email Meeting"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm,cancel"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="subject" required="1"/>
                            <field name="room_location" widget="selection"/>
                            <field name="description"/>
                            <field name="calendar_alarm" domain="[('interval','=','minutes'),('alarm_type','=','notification')]" widget="selection"/>
                            <field name="recurrency"/>
                        </group>
                        <group>
                            <field name="start_date"/>
                            <field name="end_date"/>
                            <field name="attendee" required="1" options="{'no_create_edit': True,'no_create': True}" widget="many2many_tags" domain="[('login','ilike','@Tripper.com'),('id','!=',uid)]"/>
                            <button name="create_calendar_web" type="object" string="Send Email"/>
                        </group>
                    </group>
                    <group>
                        <field name="create_uid" string="Insiator"/>
                        <field name="create_date" string="Create Date"/>
                    </group>
                    <notebook>
                        <page attrs="{'invisible': [('recurrency', '=', False)]}" string="Reccurent">
                            <group>
                                <field name="rrule_type" attrs="{'required': [('recurrency', '=', True)]}"/>
                            </group>
                            <group>
                                <field name="final_date" attrs="{'required': [('recurrency', '=', True)]}"/>
                            </group>
                        </page>
                        <page string="IT Settings" groups="base.group_system">
                            <group>
                                <field name="version"/>
                                <field name="calendar_file"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                    <field name="activity_ids" widget="mail_activity"/>
                </div>
            </form>
        </field>
    </record>

    <record id="room_location_form_view" model="ir.ui.view">
        <field name="name">room.location.form.view</field>
        <field name="model">room.location</field>
        <field name="arch" type="xml">
            <form string="Room Booking">
                <sheet>
                    <group>
                        <group>
                            <field name="name"/>
                            <field name="location_address"/>
                            <field name="location_description"/>
                            <field name="active"/>
                            <field name="tz"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="room_location_tree_view" model="ir.ui.view">
        <field name="name">room_location.tree.view</field>
        <field name="model">room.location</field>
        <field name="arch" type="xml">
            <tree string="Room Locations">
                <field name="name"/>
                <field name="location_address"/>
                <field name="location_description"/>
            </tree>
        </field>
    </record>

    <record id="virtual_room_tree_view" model="ir.ui.view">
        <field name="name">virtual.room.tree</field>
        <field name="model">virtual.room</field>
        <field name="arch" type="xml">
            <tree string="Zoom Accounts">
                <field name="name"/>
                <field name="zoom_account_id"/>
            </tree>
        </field>
    </record>

    <record id="virtual_room_form_view" model="ir.ui.view">
        <field name="name">virtual.room.form</field>
        <field name="model">virtual.room</field>
        <field name="arch" type="xml">
            <form string="Zoom Account">
                <header>
                    <button name="action_test_connection" string="Test Connection" type="object" class="btn-primary"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1><field name="name" placeholder="e.g. Zoom Marketing"/></h1>
                    </div>
                    <group>
                        <field name="zoom_account_id"/>
                        <field name="zoom_client_id"/>
                        <field name="zoom_client_secret" password="True"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="meeting_event_calendar_view" model="ir.ui.view">
        <field name="name">meeting.event.calendar</field>
        <field name="model">meeting.event</field>
        <field name="arch" type="xml">
            <calendar string="Meeting Calendar" 
                      date_start="start_date" 
                      date_stop="end_date" 
                      mode="month" 
                      quick_add="False" 
                      color="state">
                <field name="subject"/> 
                <field name="room_location_ids"/>
                <field name="attendee"/> 
                <field name="state" filters="1"/>
            </calendar>
        </field>
    </record>

    <record id="meeting_event_form_view" model="ir.ui.view">
        <field name="name">meeting.event.form</field>
        <field name="model">meeting.event</field>
        <field name="arch" type="xml">
            <form string="Meeting Event">
                <header>
                    <button name="action_confirm" type="object" states="draft" string="Confirm" class="oe_highlight"/>
                    <button name="action_cancel" type="object" states="confirm" string="Cancel"/>
                    <button name="action_draft" type="object" states="cancel" string="Reset To Draft"/>
                    
                    <button name="action_create_zoom_link" type="object" string="Create Zoom Link" class="btn-info" 
                            attrs="{'invisible': ['|', '|', ('zoom_link', '!=', False), ('state', '!=', 'confirm'), ('virtual_room_id', '=', False)]}"/> 
                    
                    <button name="action_get_meeting_summary" type="object" string="Get Summary" class="btn-warning"
                             attrs="{'invisible': ['|', ('state', '!=', 'confirm'), ('virtual_room_id', '=', False)]}"/>
                    
                    <button name="action_send_email" type="object" string="Send Email Invitation" class="btn-primary"
                            states="confirm"/>
                    
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm,cancel"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="subject" required="1"/>
                            <field name="room_location_ids" widget="many2many_tags" options="{'no_create': True}"/>
                            <field name="virtual_room_id" options="{'no_create': True, 'no_open': True}"/>
                            <field name="description"/>
                            <field name="calendar_alarm" widget="selection"/>
                            <field name="recurrency"/>
                        </group>

                        <group>
                            <field name="start_date"/>
                            <field name="end_date"/>
                            <field name="attendee" widget="many2many_tags"/>
                        </group>
                    </group>

                    <group>
                        <field name="create_uid" string="Insiator"/>
                        <field name="create_date" string="Create Date"/>
                    </group>

                    <notebook>
                        <page attrs="{'invisible': [('recurrency', '=', False)]}" string="Reccurent">
                            <group>
                                <field name="rrule_type" attrs="{'required': [('recurrency', '=', True)]}"/>
                            </group>
                            <group>
                                <field name="final_date" attrs="{'required': [('recurrency', '=', True)]}"/>
                            </group>
                        </page>
                        
                        <page string="Zoom Integration" attrs="{'invisible': [('zoom_link', '=', False), ('meeting_summary', '=', False)]}">
                            <group>
                                <field name="zoom_link" widget="url"/>
                                <field name="meeting_summary"/>
                            </group>
                        </page>

                        <page string="IT Settings" groups="base.group_system">
                            <group>
                                <field name="version"/>
                                <field name="calendar_file"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="meeting_event_tree_view" model="ir.ui.view">
        <field name="name">meeting.event.tree</field>
        <field name="model">meeting.event</field>
        <field name="arch" type="xml">
            <tree string="Meeting Events">
                <field name="subject"/>
                <field name="room_location_ids" widget="many2many_tags"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record model="ir.actions.act_window" id="action_meeting_rooms">
        <field name="name">Meeting Rooms</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">meeting.rooms</field>
        <field name="view_mode">calendar,tree,form</field>
    </record>

    <record model="ir.actions.act_window" id="action_room_location">
        <field name="name">Room Locations</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">room.location</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="action_virtual_room" model="ir.actions.act_window">
        <field name="name">Virtual Rooms (Zoom)</field>
        <field name="res_model">virtual.room</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="action_meeting_event" model="ir.actions.act_window">
        <field name="name">Meeting Events</field>
        <field name="res_model">meeting.event</field>
        <field name="view_mode">calendar,tree,form</field>
    </record>

    <menuitem name="Meeting Rooms" id="menu_meeting_rooms" parent="" action="action_meeting_rooms" sequence="60"/>
    
    <menuitem name="Meeting Events" id="menu_meeting_event" parent="menu_meeting_rooms" action="action_meeting_event" sequence="60"/>
    
    <menuitem name="Room Locations" id="menu_room_locations" parent="menu_meeting_rooms" action="action_room_location" groups="approvals.group_approval_user" sequence="61"/>

    <menuitem name="Virtual Rooms" id="menu_virtual_room" parent="menu_meeting_rooms" action="action_virtual_room" sequence="62" groups="base.group_system"/>

</odoo>